{% extends "layouts/app.html" %}
{% load static i18n %}

{% block title %}Recovery Codes - {{ block.super }}{% endblock %}

{% block content %}
<div class="flex flex-col gap-6">
  <!-- Page Header -->
  <div class="space-y-0.5">
    <h1 class="text-2xl font-bold tracking-tight md:text-3xl">Recovery Codes</h1>
    <p class="text-base-content/70">
      {% blocktranslate count unused_count=unused_codes|length %}
        There is {{ unused_count }} out of {{ total_count }} recovery code available.
      {% plural %}
        There are {{ unused_count }} out of {{ total_count }} recovery codes available.
      {% endblocktranslate %}
    </p>
  </div>

  <div class="divider my-2"></div>

  <!-- Settings Layout -->
  <div class="flex flex-1 flex-col space-y-2 overflow-hidden md:space-y-2 lg:flex-row lg:space-y-0 lg:space-x-12">
    <!-- Sidebar -->
    <aside class="top-0 lg:sticky lg:w-1/5">
      {% include "layouts/settings_nav.html" %}
    </aside>

    <!-- Content -->
    <div class="flex-1 lg:max-w-2xl">
      <div class="space-y-6">
        <!-- Recovery Codes List -->
        {% if unused_codes %}
        <div class="space-y-4">
          <div class="grid grid-cols-2 gap-4">
            {% for code in unused_codes %}
            <div class="flex items-center justify-between rounded-lg border bg-base-200 px-4 py-2 font-mono">
              {{ code }}
            </div>
            {% endfor %}
          </div>
          <div class="flex items-center justify-between">
            <p class="text-sm text-base-content/70">
              {% trans "Keep these recovery codes in a safe place. They can be used to recover access to your account if you lose your authenticator device." %}
            </p>
            <a href="{% url 'mfa_download_recovery_codes' %}" class="btn btn-ghost btn-sm">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="h-4 w-4"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
              {% trans "Download" %}
            </a>
          </div>
        </div>
        {% endif %}

        <!-- Generate New Codes -->
        <div class="flex flex-col gap-4">
          <div class="flex flex-col gap-2">
            <h3 class="text-lg font-medium">Generate New Recovery Codes</h3>
            <p class="text-base-content/70">
              {% trans "You can generate a new set of recovery codes, but this will invalidate your existing codes." %}
            </p>
          </div>
          <form method="post" action="{% url 'mfa_generate_recovery_codes' %}">
            {% csrf_token %}
            <button type="submit" class="btn btn-primary">
              {% trans "Generate New Codes" %}
            </button>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %} 